

# **1️⃣ HTML Structure**

```html
<div class="login-container">
    <h2>Login to Your Store</h2>
    <form id="loginForm">
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="text" id="email" name="email" required>
        </div>
        <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <button type="submit" class="btn" id="loginBtn">Login</button>
    </form>

    <div id="loading" class="loading">
        <p>Logging in...</p>
    </div>
    <div id="error" class="error"></div>
    <div id="success" class="success"></div>

    <p style="text-align: center; margin-top: 1rem;">
        Don't have an account? <a href="/register">Register here</a>
    </p>
</div>
```

### **Explanation:**

1. **`login-container`** – The main box containing the login form, centered on the screen.
2. **Form** – Has two input fields:

   * `email` (type text)
   * `password` (type password)
     Both have `required` to prevent empty submissions.
3. **Button** – The “Login” button with `id="loginBtn"`.
4. **Feedback divs**:

   * `loading` → shows a loading animation.
   * `error` → shows error messages.
   * `success` → shows success messages.
5. **Register link** – Redirects users to the registration page if they don’t have an account.

---

# **2️⃣ CSS Styling**

* **Page background** – Gradient from blue to purple for a modern look.
* **Login container** – White semi-transparent box with **rounded corners**, **shadow**, and **backdrop blur** for depth.
* **Inputs** – Light gray background, rounded corners, focus state changes border color to purple (matching gradient).
* **Button** – Gradient background, hover effect darkens the gradient, subtle lift animation.
* **Responsive** – Adjusts layout for screens smaller than 480px.

✅ **Purpose:** Makes the login page visually appealing and modern.

---

# **3️⃣ JavaScript Logic**

```javascript
document.addEventListener('DOMContentLoaded', function() {
    const token = localStorage.getItem('jwtToken');
    if (token) {
        window.location.href = '/dashboard';
        return;
    }

    const loginForm = document.getElementById('loginForm');
    loginForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        showLoading(true);
        hideMessages();

        try {
            const response = await fetch('/api/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            const data = await response.json();

            if (response.ok && data.token) {
                localStorage.setItem('jwtToken', data.token);
                const payload = JSON.parse(atob(data.token.split('.')[1]));
                localStorage.setItem('userRole', payload.role || "CUSTOMER");
                localStorage.setItem('username', payload.fullName || email);
                window.location.href = '/dashboard';
            } else {
                showError(data.message || 'Login failed. Please check your credentials.');
            }
        } catch (error) {
            console.error('Login error:', error);
            showError('Network error. Please try again.');
        } finally {
            showLoading(false);
        }
    });

    function showLoading(show) {
        const loginBtn = document.getElementById('loginBtn');
        const loading = document.getElementById('loading');
        if (show) {
            loading.style.display = 'block';
            loginBtn.disabled = true;
            loginBtn.textContent = 'Logging in...';
        } else {
            loading.style.display = 'none';
            loginBtn.disabled = false;
            loginBtn.textContent = 'Login';
        }
    }

    function showError(message) {
        const errorDiv = document.getElementById('error');
        const successDiv = document.getElementById('success');
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
        successDiv.style.display = 'none';
    }

    function hideMessages() {
        document.getElementById('error').style.display = 'none';
        document.getElementById('success').style.display = 'none';
    }
});
```

### **Explanation of JS Logic**

1. **Check existing token**

   * If JWT exists in `localStorage`, redirect to `/dashboard` (user is already logged in).

2. **Form submission**

   * Prevent default form behavior (`e.preventDefault()`).
   * Grab email & password from input fields.

3. **Fetch API call**

   * Send POST request to `/api/auth/login` with JSON `{ email, password }`.
   * Wait for response and parse JSON.

4. **Successful login**

   * Save `data.token` (JWT) in `localStorage`.
   * Decode JWT payload to get **role** and **username**.
   * Redirect user to `/dashboard`.

5. **Error handling**

   * Show error messages if login fails or network errors occur.

6. **Loading animation**

   * Shows a “Logging in…” message while awaiting server response.
   * Disables the login button to prevent multiple clicks.

---

# **4️⃣ How it Connects to Spring Boot Backend**

1. **Endpoint:** `POST /api/auth/login`

   * Spring Security + JWT backend authenticates user credentials.
2. **JWT Response:**

   ```json
   {
       "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
   }
   ```
3. **Frontend Actions:**

   * Stores JWT in `localStorage`.
   * Uses JWT for subsequent API calls via `Authorization: Bearer <token>`.
   * Redirects user based on role (CUSTOMER / ADMIN).

---

# **✅ Key Features of This Login Page**

* Modern gradient design + responsive layout.
* Input validation (required fields).
* Smooth **loading animation** and **error handling**.
* JWT integration for secure authentication.
* Stores **role and username** in localStorage for later use.


